{
	"sets": [
		{
			"tests": [
				{"task": "https://x.com?t=a&s=b"                                                                    , "expect": "https://x.com/"},
				{"task": "https://example.com?fb_action_ids&mc_eid&ml_subscriber_hash&oft_ck&s_cid&unicorn_click_id", "expect": "https://example.com/"},
				{
					"task": "https://www.amazon.ca/UGREEN-Charger-Compact-Adapter-MacBook/dp/B0C6DX66TN/ref=sr_1_5?crid=2CNEQ7A6QR5NM&keywords=ugreen&qid=1704364659&sprefix=ugreen%2Caps%2C139&sr=8-5&ufe=app_do%3Aamzn1.fos.b06bdbbe-20fd-4ebc-88cf-fa04f1ca0da8",
					"expect": "https://www.amazon.ca/dp/B0C6DX66TN"
				},
				{
					"task": "https://amazon.com/gp/offer-listing/123",
					"expect": "https://www.amazon.com/dp/123?aod=1"
				},

				{"task": "https://bsky.app"        , "expect": "https://bsky.app/"},
				{"task": "https://fxbsky.app"      , "expect": "https://bsky.app/profile/fxbsky.app"},
				{"task": "https://user.bsky.social", "expect": "https://bsky.app/profile/user.bsky.social"},
				{
					"task": "https://live.browserstack.com/#os=Windows&os_version=8.1&browser=IE&browser_version=11.0&start=true&ref=caniuse-source&source=landing_page&utm_source=caniuse&utm_medium=partnered&utm_campaigncode=701OW000008y9C1YAI",
					"expect": "https://live.browserstack.com/#os=Windows&os_version=8.1&browser=IE&browser_version=11.0&start=true"
				},

				{"task": "https://127.0.0.1", "expect": "https://127.0.0.1/"},
				{"task": "https://com"      , "expect": "https://com/"},
				{"task": "ftp://127.0.0.1"  , "expect": "ftp://127.0.0.1/"},
				{"task": "file://a/b/c"     , "expect": "file://a/b/c"},
				{"task": "mailto:a@a.com"   , "expect": "mailto:a@a.com"},

				{"task": "https://twitter.com"  , "expect": "https://x.com/"},
				{"task": "https://vxtwitter.com", "expect": "https://github.com/dylanpdx/BetterTwitFix"},

				{"task": "https://bsky.app/profile/user"     , "expect": "https://bsky.app/profile/user.bsky.social"},
				{"task": "https://bsky.app/profile/user.bsky", "expect": "https://bsky.app/profile/user.bsky.social"},
				{"task": "https://bsky.app/profile/user.com" , "expect": "https://bsky.app/profile/user.com"},

				{
					"task": "https://click.notification.elsevier.com/CL0/https:%2F%2Ffacebook.com%2FTheLancetMedicalJournal/1/0100017b6336ece0-e16eeb62-7506-49ae-9b9f-96c2e2caccc1-000000/XNF87Ruy8xfaatSlPiHGJWGJetPIroNvIDdfy0xkyW4=211",
					"expect": "https://www.facebook.com/TheLancetMedicalJournal"
				},

				{"task": "https://href.li/?https://example.com/?abc=123&def=456#1", "expect": "https://example.com/?abc=123&def=456#1"},

				{"task": "https://example.com/"   , "expect": "https://example.com/"},
				{"task": "https://example.com./"  , "expect": "https://example.com/"},
				{"task": "https://example.com/?"  , "expect": "https://example.com/"},
				{"task": "https://example.com./?" , "expect": "https://example.com/"},
				{"task": "https://example.com/#"  , "expect": "https://example.com/"},
				{"task": "https://example.com./#" , "expect": "https://example.com/"},
				{"task": "https://example.com/?#" , "expect": "https://example.com/"},
				{"task": "https://example.com./?#", "expect": "https://example.com/"},

				{"task": "https://127.0.0.1/"     , "expect": "https://127.0.0.1/"},
				{"task": "https://127.0.0.1/?"    , "expect": "https://127.0.0.1/"},
				{"task": "https://127.0.0.1/#"    , "expect": "https://127.0.0.1/"},
				{"task": "https://127.0.0.1/?#"   , "expect": "https://127.0.0.1/"},

				{"task": "https://www.tumblr.com/safe-mode?url=https://tumblr.com/example"  , "expect": "https://www.tumblr.com/example" },
				{"task": "https://www.tumblr.com/safe-mode?url=https://tumblr.com/example/" , "expect": "https://www.tumblr.com/example/"},
				{"task": "https://www.tumblr.com/safe-mode?url=https://tumblr.com./example" , "expect": "https://www.tumblr.com/example" },
				{"task": "https://www.tumblr.com/safe-mode?url=https://tumblr.com./example/", "expect": "https://www.tumblr.com/example/"},
				{"task": "https://www.tumblr.com/safe-mode?url=https://example.tumblr.com"  , "expect": "https://example.tumblr.com/"},
				{"task": "https://www.tumblr.com/safe-mode?url=https://example.tumblr.com." , "expect": "https://example.tumblr.com/"},

				{"task": "https://bsky.app/profile/abc"            , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc."           , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.b"          , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bs"         , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsk"        , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky"       , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky."      , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.s"     , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.so"    , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.soc"   , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.soci"  , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.socia" , "expect": "https://bsky.app/profile/abc.bsky.social"},
				{"task": "https://bsky.app/profile/abc.bsky.social", "expect": "https://bsky.app/profile/abc.bsky.social"},

				{
					"task": "https://link.sfchronicle.com/external/41488169.38548/aHR0cHM6Ly93d3cuaG90ZG9nYmlsbHMuY29tL2hhbWJ1cmdlci1tb2xkcy9idXJnZXItZG9nLW1vbGQ_c2lkPTY4MTNkMTljYzM0ZWJjZTE4NDA1ZGVjYSZzcz1QJnN0X3JpZD1udWxsJnV0bV9zb3VyY2U9bmV3c2xldHRlciZ1dG1fbWVkaXVtPWVtYWlsJnV0bV90ZXJtPWJyaWVmaW5nJnV0bV9jYW1wYWlnbj1zZmNfYml0ZWN1cmlvdXM/6813d19cc34ebce18405decaB7ef84e41",
					"expect": "https://www.hotdogbills.com/hamburger-molds/burger-dog-mold"
				},

				{
					"task": {
						"url": "https://www.washingtonpost.com/local/?itid=hp_top_nav_d.c.,%20md.%20&%20va.",
						"context": {
							"vars": {
								"Real url from the actual washington post website": "true, unfortunately"
							}
						}
					},
					"expect": "https://www.washingtonpost.com/local/"
				}
			]
		},
		{
			"params_diff": {"flags": ["no_network"]},
			"tests": [
				{"task": "https://facebook.com/share/abc", "expect": "https://www.facebook.com/share/abc"},
				{"task": "https://www.facebook.com/share/abc", "expect": "https://www.facebook.com/share/abc"}
			]
		},
		{
			"params_diff": {"flags": ["tor2web2tor"]},
			"tests": [
				{"task": "https://example.onion.com"  , "expect": "https://example.onion/"},
				{"task": "https://example.onion.co.uk", "expect": "https://example.onion/"}
			]
		},
		{
			"params_diff": {"flags": ["unbreezewiki"]},
			"tests": [
				{"task": "https://antifandom.com/tardis/wiki/Genocide", "expect": "https://tardis.fandom.com/wiki/Genocide"},

				{"task": "https://breezewiki.com/minecraft/search?q=abc", "expect": "https://minecraft.fandom.com/wiki/Special:Search?query=abc"},
				{"task": "https://breezewiki.com/minecraft/search?%71=abc", "expect": "https://minecraft.fandom.com/wiki/Special:Search?query=abc"},
				{"task": "https://breezewiki.com/minecraft", "expect": "https://minecraft.fandom.com/"}
			]
		},
		{
			"params_diff": {"flags": ["breezewiki"]},
			"tests": [
				{"task": "https://antifandom.com/tardis/wiki/Genocide", "expect": "https://breezewiki.com/tardis/wiki/Genocide"},
				{"task": "https://tardis.fandom.com/wiki/Genocide"    , "expect": "https://breezewiki.com/tardis/wiki/Genocide"},

				{"task": "https://minecraft.fandom.com/wiki/Special:Search?scope=internal&navigationSearch=true&query=abc"  , "expect": "https://breezewiki.com/minecraft/search?q=abc"},
				{"task": "https://minecraft.fandom.com/wiki/Special:Search/?scope=internal&navigationSearch=true&query=abc" , "expect": "https://breezewiki.com/minecraft/search?q=abc"},
				{"task": "https://minecraft.fandom.com/wiki/Special:Search/a?scope=internal&navigationSearch=true&query=abc", "expect": "https://breezewiki.com/minecraft/search?q=a"}
			]
		},
		{
			"params_diff": {"flags": ["unmobile"]},
			"tests": [
				{"task": "https://en.m.wikipedia.org/wiki/Self-immolation_of_Aaron_Bushnell", "expect": "https://en.wikipedia.org/wiki/Self-immolation_of_Aaron_Bushnell"},
				{"task": "https://en.m.wikipedia.org/wiki/Gaza_genocide"                    , "expect": "https://en.wikipedia.org/wiki/Gaza_genocide"},
				{"task": "https://en.m.wikipedia.org/wiki/Zionism"                          , "expect": "https://en.wikipedia.org/wiki/Zionism"}
			]
		},
		{
			"params_diff": {"flags": ["mobile"]},
			"tests": [
				{"task": "https://wikipedia.org", "expect": "https://wikipedia.org"},
				{"task": "https://en.wikipedia.org", "expect": "https://en.m.wikipedia.org"}
			]
		},
		{
			"params_diff": {"flags": ["embed_compatibility"]},
			"tests": [
				{"task": "https://bsky.app/profile/abc.bsky.social/post/123"  , "expect": "https://fxbsky.app/profile/abc.bsky.social/post/123"},
				{"task": "https://fxbsky.app/profile/abc.bsky.social/post/123", "expect": "https://fxbsky.app/profile/abc.bsky.social/post/123"}
			]
		},
		{
			"params_diff": {"flags": ["invidious"]},
			"tests": [
				{"task": "https://youtube.com/watch?v=12345", "expect": "https://yewtu.be/watch?v=12345"},
				{"task": "https://yewtu.be/watch?v=12345"   , "expect": "https://yewtu.be/watch?v=12345"}
			]
		},
		{
			"params_diff": {"flags": ["uninvidious"]},
			"tests": [
				{"task": "https://youtube.com/watch?v=12345", "expect": "https://www.youtube.com/watch?v=12345"},
				{"task": "https://yewtu.be/watch?v=12345"   , "expect": "https://www.youtube.com/watch?v=12345"}
			]
		},
		{
			"params_diff": {"flags": ["tumblr_unsubdomain_blog"]},
			"tests": [
				{"task": "https://tumblr.com/username", "expect": "https://www.tumblr.com/username"},
				{"task": "https://username.tumblr.com", "expect": "https://www.tumblr.com/username/"},
				{"task": "https://username.tumblr.com/archive/", "expect": "https://username.tumblr.com/archive/"}
			]
		},
		{
			"job_context": {
				"source_host": "furaffinity.net"
			},
			"tests": [
				{
					"task": {
						"url": "https://twitter.com/not-actually-important",
						"context": {
							"vars": {
								"unmangle_mode": "contact_info",
								"site": "twitter",
								"text": "@example"
							}
						}
					},
					"expect": "https://x.com/example"
				}
			]
		}
	]
}
